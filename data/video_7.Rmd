---
title: "video_7"
output: html_document
date: "2024-04-15"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# GGPLOT 
## Five key steps to ggplot 
There are 5 key steps in plotting in ggplot
1.**The Setup** - Read the dataset, define x and y axis 
2. **The Labels** - Title, X and Y axis labels 
3. **The Theme** - Default, Black and White, coloured etc. 
4. **The Facets** - Individual Graphs for each group in data with exactly same range
5. **The Layers or geoms** - The actual plot type - e.g Bar plot, Box plot, Violin plot etc. 

## Biology behind the data we are using 
<--Review the slide on minute 3 video 7-->


# Analysis 
Invoke the libraries 
```{r}
library(ggplot2)
library(data.table)
```

Read the data using the fread function 
```{r}
methylated_c = fread("R_WORKSHOP.csv", header=T, sep=",")
```

View the data 
```{r}
View(methylated_c)
```

Look at the data 
```{r}
str(methylated_c)
```

calculate the summary statistics 
```{r}
summary(methylated_c)
```

Do the data have null values?
```{r}
sum(is.na(methylated_c))
```

```{r}
class(methylated_c)
```


## Plotting 
### Base set up
- Define the graph skeleton
- Define the aesthetics
- Define the labels
```{r}
graph=ggplot(methylated_c, 
             aes(x=Chromosome, y=Count_in_millions))+ #graph aesthetics
  labs(x="Chromosomes", y="Cytosine count in millions", title="C distribution in A thaliana") #graph labels

print(graph)
```

- Define the type of graph - geoms
```{r}
graph1 = graph + geom_col() #plot a bar chart
print(graph1)
```

- Add some depth to the chart - introduce the third variable "Context"
Make it a stacked bar chart
```{r}
graph2=graph1+aes(fill=Context)
print(graph2)
```

- Additional modifications-grouped bar chart
```{r}
graph3=graph+geom_col(position="dodge")+aes(fill=Context)
print(graph3)
```

- Faceting - Group the charts by context
Faceted graphs 
```{r}
graph4=graph3+facet_grid(~Context)
print(graph4)
```

- Using predefined colours
```{r}
graph5=graph4+scale_fill_manual(values=c("brown", "blue", "red"))
print(graph5)
```

- Modifying the background colour
```{r}
graph5+theme_bw(base_size=9)+theme(panel.background = element_rect(fill="lightblue"))
```

- One single step - Combine the above steps into one 
```{r}
my_title = expression(paste("Cystosine distribution in ", italic("Arabidopis thaliana")))#Define the title 

graph_final = ggplot(methylated_c, aes(x=Chromosome, y=Count_in_millions))+
  labs(x="Chromosomes", title = my_title) +
  facet_grid(~Context) +
  geom_col(position="dodge")+
  aes(fill=Context)+scale_fill_manual(values = c("brown", "blue", "red"))+
  theme_bw(base_size = 9)+theme(panel.background = element_rect(fill="lightblue"))

print(graph_final)
```
The `expression` is used to combine name italics and normal fonts - this helps biologists include botanical names in charts


- The graphs can be exported as images or pdf. This can be done in RStudio
<--Show screenshots if possible-->

# Working with inbuilt iris data 
- plot a box plot to compare the sepal length in diferent iris species
```{r}
graph = ggplot(iris, aes(x=Species, y=Sepal.Length))+
  geom_boxplot()+aes(fill=Species)

print(graph)
```
Virginica have higher sepal length however some virginica have less sepal length than versicolor

Violin plot will show a better distribution than boxplot
```{r}
graph = ggplot(iris, aes(x=Species, y=Sepal.Length))+
  geom_violin()+aes(fill=Species)

print(graph)
```

- Reshaping the data into long format 
```{r}
library(tidyr) # can be used to convert from short format to long format
```

Convert to a long format
`gather` command is used to convert data into fewer columns 
```{r}
#Gather from sepal length to petal width column into type and measurement column 
iris_long = gather(iris, type, measurement, Sepal.Length:Petal.Width, factor_key = TRUE)
View(iris_long)
```

Lets plot the data to a boxplot 
```{r}
graph=ggplot(iris_long, aes(x=Species,y=measurement))+
  labs(x="Species", y="Length in cm", title = "variation in Petals and Sepals of Iris Species")+
  theme(axis.text = element_text(angle=90))+
  facet_grid(~type)+
  aes(fill=Species)+
  geom_boxplot()

print(graph)
```

the same can also be plotted to a violin plot 
```{r}
graph=ggplot(iris_long, aes(x=Species,y=measurement))+
  labs(x="Species", y="Length in cm", title = "variation in Petals and Sepals of Iris Species")+
  theme(axis.text = element_text(angle=90))+
  facet_grid(~type)+
  aes(fill=Species)+
  geom_violin()

print(graph)
```

# R Markdown 
Intoduce how to create R markdown file using screenshots 

Lets try create a vector in a copde chunk 
```{r}
vector1=c(1,2,3,4,5)
print(vector1)
```

Each chunk can be run separately in a single file, also the variable in one chunk can be reused by the next/later chunks 

Anything added outside the chuck will not be execcuted in the program

The R markdown can be knitted to a html, pdf, or word file 
<--Include screenshots-->
